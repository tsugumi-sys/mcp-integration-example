{% extends "base.html" %}
{% block content %}
<h1>Credential Detail</h1>
<a class="back-link" href="/credentials">‚Üê Back to credentials</a>
<div class="card">
  <div><strong>ID:</strong> {{ credential.id }}</div>
  <div><strong>Provider:</strong> {{ credential.provider }}</div>
  <div><strong>Name:</strong> {{ credential.name }}</div>
  <div><strong>Status:</strong> {{ credential.status }}</div>
</div>

{% if credential.provider == "google_calendar" %}
<form class="card" action="/credentials/{{ credential.id }}/oauth/start" method="post">
  <button type="submit">Connect Google Calendar</button>
</form>
{% endif %}

{% if credential.provider == "gemini" %}
<form class="card" action="/credentials/{{ credential.id }}/gemini/save" method="post">
  <div class="row">
    <label>Gemini API Key</label>
    <input name="api_key" placeholder="AIza..." />
    {% if gemini_key_tail %}
    <small>Saved key ends with ...{{ gemini_key_tail }}</small>
    {% endif %}
  </div>
  <button type="submit">Save API Key</button>
</form>
{% endif %}

{% if token %}
<div class="card">
  <div><strong>Access Token:</strong> *****</div>
  <div><strong>Refresh Token:</strong> *****</div>
  <div><strong>Expiry:</strong> {{ token.expiry }}</div>
  <div><strong>Scope:</strong> {{ token.scope }}</div>
</div>
{% endif %}

<form action="/credentials/{{ credential.id }}/delete" method="post">
  <button class="danger" type="submit">Delete</button>
</form>
{% endblock %}
